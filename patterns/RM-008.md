# RM-008: Variable and field initialization

**Risk**: uninit memory usage

**When to check**: Mandatory when any variables or structure members are read

**Pattern-specific TodoWrite fields**:
**Important context**:
- global variables and static variables are zero filled automatically
- slab and vmalloc APIs have variants that zero fill, and __GFP_ZERO gfp mask does as well
- kmem_cache_create() can use an init_once() function to initialize slab objects
  - this only happens on the first allocation, and protects us from garbage in the struct


- Variable/field: [name] - [type]
- Access type: [read/write]
- Initialized: [YES/NO]
- Where initialized: [file:line or "zero-filled" or "init_once"]
- Error paths checked: [YES/NO - list paths]
- Similar usage comparison: [if verification unclear]

**Mandatory: Mempool/Slab allocation without constructors**
- [ ] For EVERY `mempool_alloc()` or `kmem_cache_alloc()` call:
  - Create a new TodoWrite with the format:
    - variable allocated: [name]
    - kmem_cache or mempool: [name]
    - construct function definition [exact code snippet or NULL]
    - Fields initialized or uninitialized after allocation: [list]
  - Find the cache creation (kmem_cache_create(), mempool_alloc() calls)
    - Check if constructor is NULL
    - If NULL, assume ENTIRE structure contains garbage
    - Check what fields are explicitly initialized after allocation
    - Flag ANY field read before initialization, even if "obviously" should be set later

**Mandatory initialization validation:**
- step 1: read full function definitions
- step 2: track all variable/field access in modified functions in TodoWrite, even if they didn't change
- step 3: trace variable/field access to make sure they are initialized before use
  - writing structure members, or passing to functions that only write without reading, both count as initializing the member
  - check kmem_cache_alloc/mempool_alloc TodoWrite for details about slab caches
- step 5: special attention for error paths (goto fail)
- step 6: if you can't verify fully, check against other similar usage

**Mandatory Self-verification gate:**

**Pattern-specific questions** (in addition to core questions):
  1. How many variable/field accesses did you find? [number]
  2. How many variables/fields are read before initialization? [number]
  3. Have you checked error paths for EVERY variable/field? [yes/no]
  4. How many unclear cases did you compare against similar usage? [number]
  5. How many kmem_cache_alloc or mempool_alloc initializers were checked? [number]

If you cannot answer ALL questions with evidence, RESTART RM-008 from the beginning.
