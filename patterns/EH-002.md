# EH-002: ERR_PTR vs NULL consistency

**Risk**: Wrong error check

**When to check:** Mandatory when NULLs, ERR_PTRs, PTR_ERRs are checked or returned

**Pattern-specific TodoWrite fields**:
**Note:**

- ERR_PTR() holds an error cast to a pointer, but they are not valid pointers
  - foo = ERR_PTR(-ENOMEM) ; if (foo) -> TRUE, but *foo will CRASH


- Return types: Returns [ERR_PTR/NULL/both/neither], All return statements [list with values]
- Error checks: [code snippet] at [line] - [IS_ERR/NULL/IS_ERR_OR_NULL], Mixed checks [YES/NO]
- Callers (if returns changed): [name at line] - [handles correctly? YES/NO]
- Consistency: [consistent/INCONSISTENT + explanation]

**Mandatory error check validation:**
- read entire function
- never mix IS_ERR with NULL checks
- never dereference the result of ERR_PTR()
- if ERR_PTR or NULL returns are added or modified, add all callers to TodoWrite
  - ensure all callers handle handled the NULL/ERR_PTR properly
- ensure IS_ERR/NULL is consistent with all returns or checks

**Mandatory Self-verification gate:**

**Pattern-specific questions**:
  1. How many functions mix IS_ERR with NULL checks? [number]
  2. How many callers do NOT handle ERR_PTR/NULL correctly? [number]

If you cannot answer ALL questions with evidence, RESTART EH-002 from the beginning.
