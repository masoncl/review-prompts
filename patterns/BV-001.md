# BV-001: Bounds and validation at point of use

**Risk**: Buffer overflow

**When to check**: Mandatory when array or buffer indexing occurs

Place each step defined below into TodoWrite.

**Mandatory bounds validation:**
- step 1: read full function definitions
  - Add function into TodoWrite
  - Output: function name, and a random line from anywhere in each definition
    - you must prove you read the function
- step 2: check all index usage in modified functions, even if they didn't change
  - Output: quote the actual indexing code and its location
- step 3: check bounds where data accessed, not just where received
- step 4: revalidate if size can change between check and use
- step 5: validate untrusted data sources only (don't add defensive checks for trusted data)

**After analysis:** Issues found: [none OR list]

**Notes on common patterns**:
- strscpy() auto-detects array sizes when compiler can find the type
- char \*s = ""; strlen(s) returns zero, but s[0] is safe to access
- memcpy(dst + (offset & mask), src, size) usually has alignment validation elsewhere
- Global arrays with MAX_FOO: check if impossible to create more than MAX_FOO elements
