# CL-002: Lock handoff and balance

**Risk**: Missing synchronization

**When to check:** Mandatory when locked objects are returned or passed between functions

Place each step defined below into TodoWrite.

**Mandatory lock handoff validation:**
- step 1: read entire function definition
  - Add function name to TodoWrite
  - Output: function name, and a random line from anywhere in the definition
    - you must prove you read the function
- step 2: add every return statement into TodoWrite
  - Output: return statement
- Step 3: determine locks held at return time
  - add locks held into TodoWrite
  - Output: lock held and return location
- Step 4: determine locks held when function called
  - add every lock held at function call time into TodoWrite
  - Output: name of lock held
- step 5: when function returns with different lock than originally held:
  - verify original locked object's lock state properly handled
  - check if caller knows which lock to release
- step 6: when locks dropped/reacquired, verify protected objects not stale
- step 7: load definitions of locking functions to understand them correctly
  - Add lock function to TodoWrite
  - Output: lock function name, and a random line from anywhere in the definition
    - you must prove you read the lock function

**After analysis:** Issues found: [none OR list]

**Note**: For lock requirements in callees, see CS-001
